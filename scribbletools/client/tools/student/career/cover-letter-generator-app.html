<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cover Letter Generator - FREE Professional Cover Letter Maker</title>
    <meta name="description" content="Free cover letter generator! Create professional cover letters instantly. Job application letters, career templates, PDF export. 100% free!">
    <meta name="keywords" content="cover letter generator, cover letter maker, cover letter creator, job application letter, professional cover letter, cover letter template, cover letter builder, employment letter, career letters, job search letters, student cover letter, application letters, hiring letters, interview letters, job letters, free cover letter, cover letter tool, employment templates">
    <meta name="author" content="Scribble Tools">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://scribbletools.shramkavach.com/client/tools/student/career/cover-letter-generator-app.html">
    <meta property="og:title" content="Cover Letter Generator - FREE Professional Cover Letter Maker">
    <meta property="og:description" content="Free cover letter generator! Create professional cover letters instantly. Job application letters, career templates, PDF export. 100% free!">
    <meta property="og:image" content="https://scribbletools.shramkavach.com/assets/og-image.svg">
    <meta property="og:site_name" content="Scribble Tools">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://scribbletools.shramkavach.com/client/tools/student/career/cover-letter-generator-app.html">
    <meta property="twitter:title" content="Cover Letter Generator - FREE Professional Cover Letter Maker">
    <meta property="twitter:description" content="Free cover letter generator! Create professional cover letters instantly. Job application letters, career templates, PDF export. 100% free!">
    <meta property="twitter:image" content="https://scribbletools.shramkavach.com/assets/og-image.svg">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="robots" content="index, follow">
    <meta name="author" content="Scribble Tools">
    <meta name="generator" content="Scribble Tools">
    <meta name="application-name" content="Cover Letter Generator">
    <meta name="apple-mobile-web-app-title" content="Cover Letters">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#f8f4e8">
    <meta name="msapplication-navbutton-color" content="#f8f4e8">
    <meta name="apple-mobile-web-app-status-bar-style" content="#f8f4e8">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://scribbletools.shramkavach.com/client/tools/student/career/cover-letter-generator-app.html">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Professional Cover Letter Generator",
      "description": "Free professional cover letter generator with customizable templates. Create, edit, and export cover letters for job applications.",
      "url": "https://scribbletools.shramkavach.com/client/tools/student/career/cover-letter-generator-app.html",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "Any",
      "permissions": "browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Professional cover letter generator",
        "Multiple font styles",
        "Real-time preview",
        "PDF export",
        "Customizable templates",
        "Job application ready",
        "No registration required",
        "Free to use"
      ],
      "provider": {
        "@type": "Organization",
        "name": "Scribble Tools",
        "url": "https://scribbletools.shramkavach.com"
      }
    }
    </script>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Poppins for a clean, professional look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- ADDED: More fonts for different cover letter styles -->
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Roboto+Mono:wght@400;500&family=Playfair+Display:wght@700&family=Special+Elite&display=swap" rel="stylesheet">

    <!-- html2canvas library for capturing the element as an image -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- ADDED: jsPDF library for creating PDF documents -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f4e8; /* A warm, paper-like background */
        }

        /* Styling for the live preview to resemble a document */
        #cover-letter-preview {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.3s ease;
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
        }

        #cover-letter-preview:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        /* Custom scrollbar for text areas */
        textarea::-webkit-scrollbar {
            width: 8px;
        }
        textarea::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 10px;
        }
        textarea::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        textarea::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Spinner for loading state */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #D9534F;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- STYLES FOR THE STYLE PICKER --- */
        #style-selector-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 0.75rem;
        }
        .style-btn {
            padding: 0.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            background-color: #f9fafb;
        }
        .style-btn:hover {
            border-color: #D9534F;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }
        .style-btn.active {
            border-color: #D9534F;
            background-color: #fef2f2;
            color: #D9534F;
            font-weight: bold;
            box-shadow: 0 0 0 3px rgba(217, 83, 79, 0.2);
        }
        .style-btn .preview-icon {
            font-size: 2rem;
            line-height: 1;
            margin-bottom: 0.25rem;
        }
        .style-btn .style-name {
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* --- STYLES FOR THE COVER LETTER PREVIEWS --- */
        /* Base styles are defined in #cover-letter-preview */

        /* Style 1: Classic Professional */
        #cover-letter-preview.style-classic { font-family: 'Merriweather', serif; }
        #cover-letter-preview.style-classic #preview-name { color: #1f2937; }

        /* Style 2: Modern Minimalist (Default Poppins) */
        #cover-letter-preview.style-modern #preview-name { color: #111827; letter-spacing: 0.5px; }

        /* Style 3: Creative & Bold */
        #cover-letter-preview.style-creative { padding: 0; }
        #cover-letter-preview.style-creative .preview-header { background-color: #D9534F; color: white; padding: 2rem; text-align: center; border-radius: 0.5rem 0.5rem 0 0; }
        #cover-letter-preview.style-creative .preview-header #preview-name { color: white; }
        #cover-letter-preview.style-creative .main-content { padding: 2rem; }
        
        /* Style 4: Elegant & Formal */
        #cover-letter-preview.style-elegant { font-family: 'Merriweather', serif; }
        #cover-letter-preview.style-elegant #preview-name { font-family: 'Playfair Display', serif; color: #374151; }
        #cover-letter-preview.style-elegant #preview-signature { font-family: 'Playfair Display', serif; }

        /* Style 5: Tech Savvy */
        #cover-letter-preview.style-tech { font-family: 'Roboto Mono', monospace; font-size: 0.8rem; }
        #cover-letter-preview.style-tech #preview-name { font-weight: 500; color: #1d4ed8; }
        
        /* Style 6: Corporate Blue */
        #cover-letter-preview.style-corporate-blue #preview-name { color: #2563eb; }
        #cover-letter-preview.style-corporate-blue { border-top: 6px solid #2563eb; }

        /* Style 7: Academic & Scholarly */
        #cover-letter-preview.style-academic { font-family: 'Merriweather', serif; }
        #cover-letter-preview.style-academic .divider { border-bottom: 1px solid #d1d5db; margin: 1rem 0; }

        /* Style 8: Friendly & Approachable */
        #cover-letter-preview.style-friendly #preview-name { color: #059669; }

        /* Style 9: Executive Gray */
        #cover-letter-preview.style-executive-gray { font-family: 'Poppins', sans-serif; }
        #cover-letter-preview.style-executive-gray #preview-name { color: #4b5563; }
        #cover-letter-preview.style-executive-gray { border-left: 6px solid #6b7280; }

        /* Style 10: Simple Centered */
        #cover-letter-preview.style-centered .sender-info { text-align: center; }

        /* Style 11: Two-Column Layout */
        #cover-letter-preview.style-two-column { display: flex; padding: 0; }
        #cover-letter-preview.style-two-column .sidebar { width: 35%; background-color: #f3f4f6; padding: 2rem; }
        #cover-letter-preview.style-two-column .sidebar .sender-info { text-align: left; }
        #cover-letter-preview.style-two-column .main-content { width: 65%; padding: 2rem; }

        /* Style 12: Energetic Red */
        #cover-letter-preview.style-energetic-red #preview-name { color: #D9534F; }
        #cover-letter-preview.style-energetic-red { border-bottom: 6px solid #D9534F; }
        
        /* Style 13: Green & Natural */
        #cover-letter-preview.style-green-natural #preview-name { color: #15803d; }
        #cover-letter-preview.style-green-natural { border-top: 6px solid #16a34a; border-bottom: 6px solid #16a34a; }

        /* Style 14: Justified & Compact */
        #cover-letter-preview.style-justified { text-align: justify; }

        /* Style 15: Vintage Typewriter */
        #cover-letter-preview.style-typewriter { font-family: 'Special Elite', monospace; background-color: #faf8f2; border: 1px solid #e2e0d8; }
        #cover-letter-preview.style-typewriter #preview-name { color: #333; }
    </style>
    <link rel="stylesheet" href="../force-desktop-layout.css">
<link rel="stylesheet" href="/assets/css/responsive.css">
    
    <!-- Mobile Device Block Script -->
    <script>
        // Detect mobile devices and block access
        (function() {
            let isBlocked = false;
            
            function isMobileDevice() {
                const userAgent = navigator.userAgent || navigator.vendor || window.opera;
                const screenWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
                
                // Check user agent for mobile devices
                const mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i;
                const isMobileUA = mobileRegex.test(userAgent);
                
                // Check screen width (mobile devices typically < 768px)
                const isSmallScreen = screenWidth < 768;
                
                // Check if device has touch capability
                const isTouchDevice = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
                
                return isMobileUA || (isSmallScreen && isTouchDevice);
            }
            
            function showBlockingMessage() {
                if (isBlocked) return;
                isBlocked = true;
                
                document.body.innerHTML = '';
                document.body.style.cssText = 'margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #d946ef 100%); min-height: 100vh; min-height: -webkit-fill-available; display: flex; align-items: center; justify-content: center; position: relative; overflow-x: hidden; overflow-y: auto;';
                
                // Add animated background circles
                const bg = document.createElement('div');
                bg.innerHTML = `
                    <div style="position: absolute; width: 300px; height: 300px; border-radius: 50%; background: rgba(255,255,255,0.1); top: -100px; left: -100px; animation: float 6s ease-in-out infinite;"></div>
                    <div style="position: absolute; width: 200px; height: 200px; border-radius: 50%; background: rgba(255,255,255,0.08); bottom: -50px; right: -50px; animation: float 8s ease-in-out infinite reverse;"></div>
                    <style>
                        * { box-sizing: border-box; }
                        html { height: 100%; height: -webkit-fill-available; }
                        body { min-height: 100vh; min-height: -webkit-fill-available; }
                        @keyframes float {
                            0%, 100% { transform: translateY(0px) scale(1); }
                            50% { transform: translateY(-20px) scale(1.05); }
                        }
                        @media (max-width: 768px) and (orientation: portrait) {
                            body { padding: 20px 16px !important; }
                            .mobile-container { 
                                padding: 36px 20px !important; 
                                margin: auto !important;
                                max-height: none !important;
                                width: calc(100% - 32px) !important;
                            }
                            .mobile-title { font-size: 26px !important; margin-bottom: 10px !important; }
                            .mobile-subtitle { font-size: 15px !important; margin-bottom: 24px !important; }
                            .mobile-icon-box { width: 80px !important; height: 80px !important; margin-bottom: 20px !important; }
                            .mobile-icon { font-size: 44px !important; }
                            .mobile-info-box { padding: 18px !important; margin-bottom: 24px !important; }
                            .mobile-list { font-size: 13px !important; line-height: 1.7 !important; }
                            .mobile-heading { font-size: 14px !important; margin-bottom: 6px !important; }
                            .mobile-button { 
                                font-size: 15px !important; 
                                padding: 14px 32px !important;
                                width: 100% !important;
                                max-width: 100% !important;
                            }
                            .mobile-footer { margin-top: 20px !important; padding-top: 18px !important; }
                            .mobile-badge { 
                                font-size: 11px !important; 
                                padding: 10px 14px !important;
                                flex-direction: column !important;
                                gap: 6px !important;
                                text-align: center !important;
                            }
                            .mobile-badge p { font-size: 11px !important; }
                        }
                        @media (max-width: 480px) and (orientation: portrait) {
                            .mobile-container { padding: 28px 18px !important; }
                            .mobile-title { font-size: 24px !important; }
                            .mobile-subtitle { font-size: 14px !important; }
                            .mobile-icon-box { width: 70px !important; height: 70px !important; }
                            .mobile-icon { font-size: 38px !important; }
                            .mobile-list { font-size: 12px !important; }
                            .mobile-button { padding: 13px 28px !important; font-size: 14px !important; }
                        }
                    </style>
                `;
                document.body.appendChild(bg);
                
                const container = document.createElement('div');
                container.className = 'mobile-container';
                container.style.cssText = 'background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(20px); border-radius: 20px; padding: 44px 32px; text-align: center; max-width: 440px; width: 100%; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.1); position: relative; z-index: 1; margin: 20px;';
                
                container.innerHTML = `
                    <div class="mobile-icon-box" style="width: 88px; height: 88px; margin: 0 auto 20px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); border-radius: 22px; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4); transform: rotate(-3deg);">
                        <span class="mobile-icon" style="font-size: 50px; transform: rotate(3deg);">üìù</span>
                    </div>
                    
                    <h1 class="mobile-title" style="color: #1f2937; font-size: 28px; margin: 0 0 10px 0; font-weight: 800; letter-spacing: -0.5px; line-height: 1.2;">
                        Desktop Required
                    </h1>
                    
                    <p class="mobile-subtitle" style="color: #6b7280; font-size: 16px; line-height: 1.5; margin: 0 0 28px 0; font-weight: 400;">
                        The <strong style="color: #4b5563; font-weight: 600;">Cover Letter Generator</strong> is optimized for desktop and laptop computers.
                    </p>
                    
                    <div class="mobile-info-box" style="background: linear-gradient(135deg, #f0f9ff 0%, #f5f3ff 100%); padding: 20px 18px; border-radius: 14px; margin-bottom: 28px; border: 1px solid rgba(99, 102, 241, 0.1); text-align: left;">
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="font-size: 22px; line-height: 1; flex-shrink: 0; margin-top: 2px;">‚ú®</span>
                            <div style="flex: 1; min-width: 0;">
                                <h3 class="mobile-heading" style="color: #374151; font-size: 15px; margin: 0 0 8px 0; font-weight: 700;">Why Desktop Only?</h3>
                                <ul class="mobile-list" style="color: #6b7280; font-size: 13.5px; margin: 0; padding-left: 18px; line-height: 1.75;">
                                    <li style="margin-bottom: 4px;">Professional formatting & styling</li>
                                    <li style="margin-bottom: 4px;">Live preview & customization</li>
                                    <li style="margin-bottom: 4px;">High-quality PNG export</li>
                                    <li>Better editing experience</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <a href="/" class="mobile-button" style="display: inline-flex; align-items: center; justify-content: center; gap: 8px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; padding: 15px 36px; border-radius: 12px; text-decoration: none; font-weight: 600; font-size: 15px; box-shadow: 0 4px 16px rgba(99, 102, 241, 0.4); transition: all 0.3s ease; border: none; width: auto; max-width: 220px; touch-action: manipulation;">
                        <span style="font-size: 17px; line-height: 1;">‚Üê</span>
                        <span>Back to Home</span>
                    </a>
                    
                    <div class="mobile-footer" style="margin-top: 24px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                        <div class="mobile-badge" style="display: inline-flex; align-items: center; justify-content: center; gap: 8px; background: #f9fafb; padding: 11px 18px; border-radius: 8px; border: 1px solid #e5e7eb; max-width: 100%;">
                            <span style="font-size: 18px; line-height: 1; flex-shrink: 0;">üîÑ</span>
                            <p style="color: #9ca3af; font-size: 12px; margin: 0; font-weight: 500; text-align: center; line-height: 1.4;">
                                Switching to desktop? Page reloads automatically at ‚â•768px
                            </p>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(container);
                
                // Add hover effect to button
                const btn = container.querySelector('a');
                btn.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px)';
                    this.style.boxShadow = '0 8px 24px rgba(99, 102, 241, 0.5)';
                });
                btn.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = '0 4px 16px rgba(99, 102, 241, 0.4)';
                });
            }
            
            function checkAndBlockOrReload() {
                if (isMobileDevice()) {
                    if (!isBlocked) {
                        showBlockingMessage();
                    }
                } else {
                    // If screen size increases to desktop and page is blocked, reload
                    if (isBlocked) {
                        window.location.reload();
                    }
                }
            }
            
            // Initial check on page load
            if (isMobileDevice()) {
                document.addEventListener('DOMContentLoaded', function() {
                    showBlockingMessage();
                });
                
                // Hide the page immediately
                document.documentElement.style.display = 'none';
                setTimeout(function() {
                    document.documentElement.style.display = 'block';
                }, 0);
            }
            
            // Monitor screen size changes (e.g., rotating device, resizing browser)
            let resizeTimer;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(function() {
                    checkAndBlockOrReload();
                }, 250); // Debounce resize events
            });
            
            // Also check on orientation change
            window.addEventListener('orientationchange', function() {
                setTimeout(function() {
                    checkAndBlockOrReload();
                }, 300);
            });
        })();
    </script>
</head>
<body class="antialiased text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-[#D9534F] mb-2">Cover Letter Generator</h1>
            <p class="text-gray-600 max-w-3xl mx-auto">
                Fill in your details, choose a professional style, and generate a cover letter. You can download it as a high-quality, crisp PNG image, perfect for online applications.
            </p>
        </header>

        <div class="flex flex-col lg:flex-row gap-8">

            <!-- Left Panel: Input Form -->
            <div class="lg:w-1/2 bg-white p-6 rounded-2xl shadow-lg border border-gray-200">
                <h2 class="text-2xl font-bold mb-6 border-b pb-3 text-gray-700">Your Information</h2>
                <form id="letter-form" class="space-y-4">
                    <input type="text" id="full-name" placeholder="Your Full Name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D9534F]" value="Alex Doe">
                    <input type="text" id="address" placeholder="Your Address, City, ZIP Code" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D9534F]" value="123 Maple Street, Anytown, USA 12345">
                    <input type="text" id="phone" placeholder="Your Phone Number" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D9534F]" value="(123) 456-7890">
                    <input type="email" id="email" placeholder="Your Email Address" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D9534F]" value="alex.doe@email.com">
                    
                    <h2 class="text-2xl font-bold mb-2 pt-6 border-b pb-3 text-gray-700">Recipient Information</h2>
                    <input type="text" id="hiring-manager" placeholder="Hiring Manager's Name (e.g., Jane Smith)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D9534F]" value="Jane Smith">
                    <input type="text" id="company-name" placeholder="Company Name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D9534F]" value="Innovate Inc.">
                    <input type="text" id="company-address" placeholder="Company Address" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D9534F]" value="456 Innovation Drive, Techville, USA 54321">

                    <h2 class="text-2xl font-bold mb-2 pt-6 border-b pb-3 text-gray-700">Letter Content</h2>
                    <textarea id="letter-body" rows="12" placeholder="Write the body of your cover letter here..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D9534F]">Dear Ms. Smith,

I am writing to express my keen interest in the Software Engineer position at Innovate Inc., which I saw advertised on TechCareers.com. With over five years of experience in full-stack development and a proven track record of delivering high-quality software solutions, I am confident that I possess the skills and passion necessary to be a valuable asset to your team.

In my previous role at Solutions Corp, I was instrumental in developing a scalable microservices architecture that improved system performance by 30%. I am proficient in JavaScript, Python, and modern frameworks like React and Django. My experience aligns perfectly with the requirements of this role, and I am excited by the opportunity to contribute to Innovate Inc.'s groundbreaking projects.

Thank you for considering my application. I have attached my resume for your review and welcome the opportunity to discuss my qualifications further.
                    </textarea>
                    <input type="text" id="closing" placeholder="Closing (e.g., Sincerely)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D9534F]" value="Sincerely,">
                </form>
            </div>

            <!-- Right Panel: Live Preview & Download -->
            <div class="lg:w-1/2">
                <div class="sticky top-8">
                    <h2 class="text-2xl font-bold mb-4 text-center text-gray-700">Choose Your Style</h2>
                    <div id="style-selector-grid" class="mb-6 bg-white p-4 rounded-xl shadow-inner border">
                        <!-- Style buttons will be injected by JS -->
                    </div>

                    <h2 class="text-2xl font-bold mb-4 text-center text-gray-700">Live Preview</h2>
                    
                    <!-- This is the element that will be captured by html2canvas -->
                    <div id="cover-letter-preview" class="w-full bg-white p-8 md:p-12 rounded-lg border border-gray-200 min-h-[600px] text-sm">
                        <!-- Placeholder for complex layouts like two-column -->
                        <div class="preview-header"></div>
                        <div class="sidebar"></div>
                        <div class="main-content"></div>
                        
                        <div class="sender-info text-right mb-8">
                            <p id="preview-name" class="font-bold text-lg"></p>
                            <p id="preview-address"></p>
                            <p id="preview-phone"></p>
                            <p id="preview-email"></p>
                        </div>
                        
                        <div class="divider"></div>

                        <div class="mb-8">
                            <p id="preview-date" class=""></p>
                        </div>
                        
                        <div class="mb-4">
                            <p id="preview-hiring-manager" class="font-bold"></p>
                            <p id="preview-company-name"></p>
                            <p id="preview-company-address"></p>
                        </div>
                        
                        <div id="preview-body" class="whitespace-pre-wrap"></div>
                        
                        <div class="divider"></div>

                        <div class="mt-8">
                            <p id="preview-closing"></p>
                            <p id="preview-signature" class="mt-4 font-bold"></p>
                        </div>
                    </div>
                    
                    <div id="download-controls" class="mt-6 flex flex-col md:flex-row justify-center items-center gap-4">
                        <button id="download-btn" class="bg-[#D9534F] text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-[#c44347] transition-all duration-300 transform hover:scale-105 w-full md:w-auto flex items-center justify-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                            Download as PNG
                        </button>
                        <button id="pdf-download-btn" class="bg-gray-700 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-gray-800 transition-all duration-300 transform hover:scale-105 w-full md:w-auto flex items-center justify-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M2 2a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H2zm2 4a1 1 0 100 2h8a1 1 0 100-2H4z" /></svg>
                            Download as PDF
                        </button>
                    </div>
                    <div id="loading-indicator" class="mt-4 hidden items-center justify-center gap-2 text-gray-600">
                        <div class="loader"></div>
                        <span>Generating your high-quality file...</span>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Get all form and preview elements
            const form = document.getElementById('letter-form');
            const inputs = form.querySelectorAll('input, textarea');
            const previewElement = document.getElementById('cover-letter-preview');
            const styleSelectorGrid = document.getElementById('style-selector-grid');
            
            const previewElements = {
                name: document.getElementById('preview-name'),
                address: document.getElementById('preview-address'),
                phone: document.getElementById('preview-phone'),
                email: document.getElementById('preview-email'),
                date: document.getElementById('preview-date'),
                hiringManager: document.getElementById('preview-hiring-manager'),
                companyName: document.getElementById('preview-company-name'),
                companyAddress: document.getElementById('preview-company-address'),
                body: document.getElementById('preview-body'),
                closing: document.getElementById('preview-closing'),
                signature: document.getElementById('preview-signature')
            };

            const downloadBtn = document.getElementById('download-btn');
            const pdfDownloadBtn = document.getElementById('pdf-download-btn');
            const loadingIndicator = document.getElementById('loading-indicator');

            // --- Define the 15 styles ---
            const styles = [
                { id: 'style-classic', name: 'Classic', icon: 'üìú' },
                { id: 'style-modern', name: 'Modern', icon: '‚ú®' },
                { id: 'style-creative', name: 'Creative', icon: 'üé®' },
                { id: 'style-elegant', name: 'Elegant', icon: '‚úíÔ∏è' },
                { id: 'style-tech', name: 'Tech', icon: 'üíª' },
                { id: 'style-corporate-blue', name: 'Corporate', icon: 'üè¢' },
                { id: 'style-academic', name: 'Academic', icon: 'üéì' },
                { id: 'style-friendly', name: 'Friendly', icon: 'üòä' },
                { id: 'style-executive-gray', name: 'Executive', icon: 'üíº' },
                { id: 'style-centered', name: 'Centered', icon: 'üéØ' },
                { id: 'style-two-column', name: 'Two Column', icon: 'üìë' },
                { id: 'style-energetic-red', name: 'Energetic', icon: 'üî•' },
                { id: 'style-green-natural', name: 'Natural', icon: 'üåø' },
                { id: 'style-justified', name: 'Justified', icon: 'üìö' },
                { id: 'style-typewriter', name: 'Typewriter', icon: 'üì†' }
            ];

            // --- Populate Style Selector ---
            function populateStyles() {
                styles.forEach(style => {
                    const btn = document.createElement('button');
                    btn.className = 'style-btn';
                    btn.dataset.style = style.id;
                    btn.innerHTML = `
                        <div class="preview-icon">${style.icon}</div>
                        <div class="style-name">${style.name}</div>
                    `;
                    styleSelectorGrid.appendChild(btn);
                });
            }

            // --- Function to handle style changes ---
            function setStyle(styleId) {
                // Remove all other style classes from the preview element
                styles.forEach(s => previewElement.classList.remove(s.id));
                // Add the new style class
                if (styleId) {
                    previewElement.classList.add(styleId);
                }

                // Update active state on buttons
                document.querySelectorAll('.style-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.style === styleId);
                });
                
                // Special handling for complex layouts
                handleComplexLayouts(styleId);
            }

            // --- Robust logic for layouts that move DOM elements ---
            function handleComplexLayouts(styleId) {
                // Get all the dynamic content blocks and special containers
                const header = previewElement.querySelector('.preview-header');
                const sidebar = previewElement.querySelector('.sidebar');
                const mainContent = previewElement.querySelector('.main-content');

                const senderInfo = document.querySelector('.sender-info');
                const dateBlock = document.querySelector('#preview-date').parentElement;
                const recipientBlock = document.querySelector('#preview-hiring-manager').parentElement;
                const bodyBlock = document.getElementById('preview-body');
                const closingBlock = document.querySelector('#preview-closing').parentElement;
                const dividers = document.querySelectorAll('.divider');

                // --- First, reset all elements to their default parent (the main preview container) ---
                // This ensures a clean slate before applying a new style.
                previewElement.append(senderInfo, dividers[0], dateBlock, recipientBlock, bodyBlock, dividers[1], closingBlock);
                
                // Clear out special containers to prevent duplication
                header.innerHTML = '';
                sidebar.innerHTML = '';
                mainContent.innerHTML = '';

                // --- Now, apply the specific layout if needed ---
                if (styleId === 'style-creative') {
                    // Move sender info into the creative header
                    header.appendChild(senderInfo);
                    // Move the rest of the content into the main-content div for this style
                    mainContent.append(dateBlock, recipientBlock, bodyBlock, closingBlock);
                } else if (styleId === 'style-two-column') {
                    // Move sender info into the sidebar
                    sidebar.appendChild(senderInfo);
                    // Move the rest of the content into the main-content div for this style
                    mainContent.append(dateBlock, recipientBlock, bodyBlock, closingBlock);
                }
                // For all other styles, the reset action at the beginning is all that's needed.
            }


            // --- Event listener for style selector ---
            styleSelectorGrid.addEventListener('click', (e) => {
                const styleBtn = e.target.closest('.style-btn');
                if (styleBtn) {
                    const styleId = styleBtn.dataset.style;
                    setStyle(styleId);
                }
            });


            // --- Function to update the live preview ---
            function updatePreview() {
                // Get values from the form
                const values = {
                    fullName: document.getElementById('full-name').value,
                    address: document.getElementById('address').value,
                    phone: document.getElementById('phone').value,
                    email: document.getElementById('email').value,
                    hiringManager: document.getElementById('hiring-manager').value,
                    companyName: document.getElementById('company-name').value,
                    companyAddress: document.getElementById('company-address').value,
                    body: document.getElementById('letter-body').value,
                    closing: document.getElementById('closing').value
                };

                // Populate the preview elements
                previewElements.name.textContent = values.fullName;
                previewElements.address.textContent = values.address;
                previewElements.phone.textContent = values.phone;
                previewElements.email.textContent = values.email;
                previewElements.date.textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                previewElements.hiringManager.textContent = values.hiringManager;
                previewElements.companyName.textContent = values.companyName;
                previewElements.companyAddress.textContent = values.companyAddress;
                previewElements.body.textContent = values.body;
                previewElements.closing.textContent = values.closing;
                previewElements.signature.textContent = values.fullName;
            }

            // --- Event listener for form inputs to update preview in real-time ---
            inputs.forEach(input => {
                input.addEventListener('keyup', updatePreview);
            });

            // --- Event listener for the download button ---
            downloadBtn.addEventListener('click', async () => {
                loadingIndicator.style.display = 'flex';
                downloadBtn.disabled = true;
                pdfDownloadBtn.disabled = true;

                // FIX 1: FONT RENDERING - Wait for fonts to be loaded and ready
                // This ensures that custom fonts are rendered correctly in the canvas.
                await document.fonts.ready;
                console.log("Fonts are loaded. Capturing canvas...");

                const previewElement = document.getElementById('cover-letter-preview');

                try {
                    const canvas = await html2canvas(previewElement, {
                        // FIX 2: RENDERING QUALITY - Use a higher scale for better resolution.
                        // A scale of 2 is good for most displays, 3 for very high-res screens.
                        scale: 2,
                        
                        // FIX 3: TEXT ENCODING & EXTERNAL RESOURCES
                        // These options help with rendering and prevent issues with external content.
                        useCORS: true,      // Allows loading cross-origin images if any were used.
                        allowTaint: true,   // Important for CORS.
                        logging: false      // Clean up console logs from the library.
                    });

                    // Create a link to download the image
                    const link = document.createElement('a');
                    link.download = 'cover-letter.png';
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                    
                } catch (error) {
                    console.error('Oops, something went wrong!', error);
                    alert('Sorry, there was an error generating the image. Please try again.');
                } finally {
                    // Hide loading indicator and re-enable the button
                    loadingIndicator.style.display = 'none';
                    downloadBtn.disabled = false;
                    pdfDownloadBtn.disabled = false;
                }
            });

            // --- ADDED: Event listener for the PDF download button ---
            pdfDownloadBtn.addEventListener('click', async () => {
                loadingIndicator.style.display = 'flex';
                downloadBtn.disabled = true;
                pdfDownloadBtn.disabled = true;

                await document.fonts.ready;
                const previewElement = document.getElementById('cover-letter-preview');

                try {
                    const canvas = await html2canvas(previewElement, {
                        scale: 2,
                        useCORS: true,
                        allowTaint: true,
                        logging: false
                    });

                    const imgData = canvas.toDataURL('image/png');
                    
                    // Initialize jsPDF
                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF('p', 'mm', 'a4');
                    
                    // A4 page dimensions in mm: 210 x 297
                    const pdfWidth = pdf.internal.pageSize.getWidth();
                    const pdfHeight = pdf.internal.pageSize.getHeight();
                    
                    // Calculate image dimensions to fit on the page while maintaining aspect ratio
                    const imgProps = pdf.getImageProperties(imgData);
                    const margin = 15; // 15mm margin on each side
                    const contentWidth = pdfWidth - margin * 2;
                    const contentHeight = (imgProps.height * contentWidth) / imgProps.width;

                    // Check if content exceeds page height
                    if (contentHeight > (pdfHeight - margin * 2)) {
                        console.warn("Warning: The generated content might be too long for a single A4 page.");
                    }

                    pdf.addImage(imgData, 'PNG', margin, margin, contentWidth, contentHeight);
                    pdf.save('cover-letter.pdf');

                } catch (error) {
                    console.error('Oops, something went wrong while creating the PDF!', error);
                    alert('Sorry, there was an error generating the PDF. Please try again.');
                } finally {
                    // Hide loading indicator and re-enable buttons
                    loadingIndicator.style.display = 'none';
                    downloadBtn.disabled = false;
                    pdfDownloadBtn.disabled = false;
                }
            });

            // Initial call to populate the preview on page load
            populateStyles();
            setStyle('style-classic'); // Set a default style
            updatePreview();
        });
    </script>
</body>
</html>


