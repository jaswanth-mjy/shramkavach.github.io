<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Generator - FREE Strong & Secure Random Password Creator</title>
    <meta name="description" content="Free password generator! Create strong, secure, random passwords with custom length, symbols, numbers. Password strength checker included. 100% free!">
    <meta name="keywords" content="password generator, strong password generator, secure password creator, random password generator, password maker tool, safe password generator, complex password creator, custom password generator, password strength checker, secure password tool, random password creator, strong password maker, password security tool, password creation tool, safe password maker, secure random passwords, password complexity tool, strong password creator, password builder tool, secure password generator online, random secure passwords, password generation tool, strong password tool, custom password creator, password safety tool">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://scribbletools.shramkavach.com/client/tools/other/password-generator.html">
    <meta property="og:title" content="Password Generator - FREE Strong & Secure Random Password Creator">
    <meta property="og:description" content="Free password generator! Create strong, secure, random passwords with custom length, symbols, numbers. Password strength checker included. 100% free!">
    <meta property="og:image" content="https://scribbletools.shramkavach.com/assets/og-image.svg">
    <meta property="og:site_name" content="Scribble Tools">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://scribbletools.shramkavach.com/client/tools/other/password-generator.html">
    <meta property="twitter:title" content="Password Generator - FREE Strong & Secure Random Password Creator">
    <meta property="twitter:description" content="Free password generator! Create strong, secure, random passwords with custom length, symbols, numbers. Password strength checker included. 100% free!">
    <meta property="twitter:image" content="https://scribbletools.shramkavach.com/assets/og-image.svg">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="robots" content="index, follow">
    <meta name="author" content="Scribble Tools">
    <meta name="generator" content="Scribble Tools">
    <meta name="application-name" content="Password Generator">
    <meta name="apple-mobile-web-app-title" content="Password Generator">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#D9534F">
    <meta name="msapplication-navbutton-color" content="#D9534F">
    <meta name="apple-mobile-web-app-status-bar-style" content="#D9534F">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://scribbletools.shramkavach.com/client/tools/other/password-generator.html">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Password Generator",
      "description": "Free online password generator for creating strong, secure, random passwords with customizable length, symbols, numbers, and complexity options.",
      "url": "https://scribbletools.shramkavach.com/client/tools/other/password-generator.html",
      "applicationCategory": "SecurityApplication",
      "operatingSystem": "Any",
      "permissions": "browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Strong password generation",
        "Custom password length",
        "Symbol and number options",
        "Password strength checker",
        "Secure random generation",
        "Multiple password creation",
        "No data storage",
        "Free security tool"
      ],
      "provider": {
        "@type": "Organization",
        "name": "Scribble Tools",
        "url": "https://scribbletools.shramkavach.com"
      }
    }
    </script>
    <style>
        /* Scope all styles to the password generator container to avoid leaking to index/header */
        .password-gen-container { max-width: 800px; margin: 2em auto; background: #fff; border-radius: 1.2em; box-shadow: 0 4px 24px #eae3d5; padding: 2em 1.5em 2.5em 1.5em; }
        .password-gen-container .handwritten { font-family: 'Caveat', cursive; }
        .password-gen-container .gen-label { font-weight: 600; margin-bottom: 0.5em; display: block; color: #4682B4; }
        .password-gen-container .gen-input { width: 100%; padding: 0.8em; border: 2px solid #EAE3D5; border-radius: 0.5em; font-size: 1em; margin-bottom: 1em; background: #FDFBF5; font-family: 'Fira Code', monospace; }
        .password-gen-container .gen-range { width: 100%; margin-bottom: 1em; }
        .password-gen-container .gen-checkbox { margin-right: 0.5em; }
        .password-gen-container .gen-checkbox-label { display: flex; align-items: center; margin-bottom: 0.8em; cursor: pointer; }
        .password-gen-container .gen-btn { background: #228B22; color: #fff; border: none; border-radius: 0.5em; padding: 1em 2em; font-weight: 600; cursor: pointer; transition: all 0.2s; margin-right: 1em; font-size: 1.1em; }
        .password-gen-container .gen-btn:hover { background: #1e7e1e; }
        .password-gen-container .gen-btn.secondary { background: #4682B4; }
        .password-gen-container .gen-btn.secondary:hover { background: #365F8A; }
        .password-gen-container .gen-btn.danger { background: #D9534F; }
        .password-gen-container .gen-btn.danger:hover { background: #c9302c; }
        .password-gen-container .password-output { background: #FDFBF5; border: 2px solid #228B22; border-radius: 0.7em; padding: 1.5em; font-size: 1.3em; color: #228B22; margin: 1.5em 0; text-align: center; font-family: 'Fira Code', monospace; font-weight: bold; word-break: break-all; position: relative; }
        .password-gen-container .password-actions { display: flex; gap: 1em; margin: 1em 0; flex-wrap: wrap; }
        .password-gen-container .strength-meter { margin: 1em 0; }
        .password-gen-container .strength-bar { width: 100%; height: 1em; background: #EAE3D5; border-radius: 0.5em; overflow: hidden; }
        .password-gen-container .strength-fill { height: 100%; transition: all 0.3s; border-radius: 0.5em; }
        .password-gen-container .strength-text { font-weight: 600; margin-top: 0.5em; }
        .password-gen-container .options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2em; margin: 2em 0; }
        .password-gen-container .option-group { background: #F8F9FA; border-radius: 0.7em; padding: 1.5em; }
        .password-gen-container .option-group h3 { color: #4682B4; margin: 0 0 1em 0; }
        .password-gen-container .password-history { background: #F0F8FF; border: 1px solid #B0C4DE; border-radius: 0.7em; padding: 1.5em; margin: 2em 0; }
        .password-gen-container .password-history h3 { color: #4682B4; margin: 0 0 1em 0; }
        .password-gen-container .history-item { background: white; border-radius: 0.3em; padding: 1em; margin: 0.5em 0; display: flex; justify-content: space-between; align-items: center; }
        .password-gen-container .history-password { font-family: 'Fira Code', monospace; font-weight: bold; flex: 1; margin-right: 1em; word-break: break-all; }
        .password-gen-container .tips-section { background: #FFF8DC; border: 1px solid #FFD700; border-radius: 0.7em; padding: 1.5em; margin: 2em 0; }
        .password-gen-container .tips-section h3 { color: #DAA520; margin: 0 0 1em 0; }
        .password-gen-container .tip-item { margin: 0.8em 0; padding-left: 1.5em; position: relative; }
        .password-gen-container .tip-item:before { content: "ðŸ’¡"; position: absolute; left: 0; }
        .password-gen-container .bulk-section { background: #E8F5E8; border: 1px solid #90EE90; border-radius: 0.7em; padding: 1.5em; margin: 2em 0; }
        .password-gen-container .bulk-section h3 { color: #228B22; margin: 0 0 1em 0; }
        .password-gen-container .bulk-passwords { background: white; border-radius: 0.3em; padding: 1em; margin: 1em 0; font-family: 'Fira Code', monospace; font-size: 0.9em; max-height: 300px; overflow-y: auto; white-space: pre-line; }
        .password-gen-container .main-title { font-size: 3em; color: #FF6B6B; margin: 0 0 0.5em 0; padding-top: 0; text-align: center; }
        .password-gen-container .main-description { font-size: 1.2em; margin-bottom: 2em; color: #666; text-align: center; }
        .password-gen-container .generate-section { text-align: center; margin: 2em 0; }
        .password-gen-container .hidden { display: none; }
        .password-gen-container .help-text { color: #666; }
        .password-gen-container .about-section { max-width: fit-content; margin: 2.5em auto 0 auto; background: #FDFBF5; border: 2px solid #EAE3D5; border-radius: 0.9em; padding: 1.5em 1.2em; font-size: 1.08em; color: #333; line-height: 1.7; }
        .password-gen-container .about-title { font-size: 1.18em; color: #D9534F; }
        .password-gen-container .feature-list { margin-left: 1.2em; }
        @media (max-width: 600px) { 
            .password-gen-container { padding: 1em 0.5em; }
            .password-gen-container .options-grid { grid-template-columns: 1fr; gap: 1em; }
            .password-gen-container .password-actions { flex-direction: column; }
        }
    </style>
</head>
<body>
<div class="password-gen-container">
    <h1 class="handwritten main-title">Password Generator</h1>
    <p class="main-description">Generate strong, secure passwords with customizable options. Perfect for accounts, WiFi, and security needs.</p>
    
    <div class="options-grid">
        <div class="option-group">
            <h3>Password Length</h3>
            <label class="gen-label">Length: <span id="length-display">12</span> characters</label>
            <input type="range" id="password-length" class="gen-range" min="4" max="128" value="12" title="Password length slider">
            <small class="help-text">Recommended: 12+ characters</small>
        </div>
        
        <div class="option-group">
            <h3>Character Types</h3>
            <label class="gen-checkbox-label">
                <input type="checkbox" id="include-uppercase" class="gen-checkbox" checked>
                Uppercase Letters (A-Z)
            </label>
            <label class="gen-checkbox-label">
                <input type="checkbox" id="include-lowercase" class="gen-checkbox" checked>
                Lowercase Letters (a-z)
            </label>
            <label class="gen-checkbox-label">
                <input type="checkbox" id="include-numbers" class="gen-checkbox" checked>
                Numbers (0-9)
            </label>
            <label class="gen-checkbox-label">
                <input type="checkbox" id="include-symbols" class="gen-checkbox" checked>
                Symbols (!@#$%^&*)
            </label>
            <label class="gen-checkbox-label">
                <input type="checkbox" id="include-extended" class="gen-checkbox">
                Extended Symbols ({|}[]~`)
            </label>
        </div>
    </div>
    
    <div class="option-group">
        <h3>Advanced Options</h3>
        <label class="gen-checkbox-label">
            <input type="checkbox" id="exclude-ambiguous" class="gen-checkbox">
            Exclude Ambiguous Characters (0, O, l, I, 1)
        </label>
        <label class="gen-checkbox-label">
            <input type="checkbox" id="exclude-similar" class="gen-checkbox">
            Exclude Similar Characters (il1Lo0O)
        </label>
        <label class="gen-checkbox-label">
            <input type="checkbox" id="require-each-type" class="gen-checkbox" checked>
            Require at least one character from each selected type
        </label>
        <label class="gen-checkbox-label">
            <input type="checkbox" id="no-repeating" class="gen-checkbox">
            No repeating characters
        </label>
    </div>
    
    <div class="generate-section">
        <button id="generate-btn" class="gen-btn">Generate Password</button>
        <button id="generate-multiple-btn" class="gen-btn secondary">Generate 5 Passwords</button>
    </div>
    
    <div id="password-result" class="hidden">
        <div class="password-output" id="password-display"></div>
        
        <div class="password-actions">
            <button id="copy-btn" class="gen-btn secondary">Copy Password</button>
            <button id="regenerate-btn" class="gen-btn">Generate New</button>
            <button id="save-btn" class="gen-btn secondary">Save to History</button>
        </div>
        
        <div class="strength-meter">
            <label class="gen-label">Password Strength:</label>
            <div class="strength-bar">
                <div class="strength-fill" id="strength-fill"></div>
            </div>
            <div class="strength-text" id="strength-text"></div>
        </div>
    </div>
    
    <div class="bulk-section">
        <h3>Bulk Password Generation</h3>
        <label class="gen-label" for="bulk-count">Number of passwords:</label>
        <input type="number" id="bulk-count" class="gen-input" value="10" min="1" max="100" title="Number of passwords to generate">
        <button id="bulk-generate-btn" class="gen-btn">Generate Multiple Passwords</button>
        <div class="bulk-passwords hidden" id="bulk-passwords"></div>
        <button id="bulk-copy-btn" class="gen-btn secondary hidden">Copy All</button>
        <button id="bulk-download-btn" class="gen-btn secondary hidden">Download as Text</button>
    </div>
    
    <div class="password-history hidden" id="password-history">
        <h3>Password History</h3>
        <div id="history-list"></div>
        <button id="clear-history-btn" class="gen-btn danger">Clear History</button>
    </div>
    
    <div class="tips-section">
        <h3>Password Security Tips</h3>
        <div class="tip-item">Use a unique password for each account</div>
        <div class="tip-item">Consider using a password manager</div>
        <div class="tip-item">Longer passwords are generally more secure</div>
        <div class="tip-item">Include a mix of character types</div>
        <div class="tip-item">Avoid dictionary words and personal information</div>
        <div class="tip-item">Change passwords regularly for sensitive accounts</div>
        <div class="tip-item">Enable two-factor authentication when available</div>
    </div>
</div>

<div class="about-section">
    <strong class="about-title">About the Password Generator</strong><br><br>
    <strong>What is this?</strong><br>
    A secure password generator that creates strong, random passwords to protect your accounts and data. Generate passwords with customizable length and character sets.<br><br>
    <strong>Features:</strong>
    <ul class="feature-list">
        <li>Customizable password length (4-128 characters)</li>
        <li>Multiple character type options</li>
        <li>Password strength assessment</li>
        <li>Bulk password generation</li>
        <li>Password history and management</li>
        <li>Copy and download functionality</li>
        <li>Advanced filtering options</li>
        <li>Security tips and best practices</li>
    </ul>
</div>

<script>
(function() {
    'use strict';
    
    // Character sets
    const charSets = {
        uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
        lowercase: 'abcdefghijklmnopqrstuvwxyz',
        numbers: '0123456789',
        symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?',
        extended: '~`'
    };
    
    const ambiguousChars = '0O1lI';
    const similarChars = 'il1Lo0O';
    
    let passwordHistory = JSON.parse(localStorage.getItem('passwordHistory') || '[]');
    
    // DOM elements will be initialized after DOM loads
    let lengthSlider, lengthDisplay, generateBtn, generateMultipleBtn, passwordResult, passwordDisplay;
    let copyBtn, regenerateBtn, saveBtn, strengthFill, strengthText, bulkGenerateBtn;
    let bulkPasswords, bulkCopyBtn, bulkDownloadBtn, passwordHistoryDiv, historyList, clearHistoryBtn;
    
    // Initialize
    function initializePasswordGenerator() {
        // Initialize DOM elements
        lengthSlider = document.getElementById('password-length');
        lengthDisplay = document.getElementById('length-display');
        generateBtn = document.getElementById('generate-btn');
        generateMultipleBtn = document.getElementById('generate-multiple-btn');
        passwordResult = document.getElementById('password-result');
        passwordDisplay = document.getElementById('password-display');
        copyBtn = document.getElementById('copy-btn');
        regenerateBtn = document.getElementById('regenerate-btn');
        saveBtn = document.getElementById('save-btn');
        strengthFill = document.getElementById('strength-fill');
        strengthText = document.getElementById('strength-text');
        bulkGenerateBtn = document.getElementById('bulk-generate-btn');
        bulkPasswords = document.getElementById('bulk-passwords');
        bulkCopyBtn = document.getElementById('bulk-copy-btn');
        bulkDownloadBtn = document.getElementById('bulk-download-btn');
        passwordHistoryDiv = document.getElementById('password-history');
        historyList = document.getElementById('history-list');
        clearHistoryBtn = document.getElementById('clear-history-btn');
        
        updateLengthDisplay();
        updateHistoryDisplay();
        
        lengthSlider.addEventListener('input', updateLengthDisplay);
        generateBtn.addEventListener('click', generateSinglePassword);
        generateMultipleBtn.addEventListener('click', generateMultiplePasswords);
        copyBtn.addEventListener('click', copyPassword);
        regenerateBtn.addEventListener('click', generateSinglePassword);
        saveBtn.addEventListener('click', savePasswordToHistory);
        bulkGenerateBtn.addEventListener('click', generateBulkPasswords);
        bulkCopyBtn.addEventListener('click', copyBulkPasswords);
        bulkDownloadBtn.addEventListener('click', downloadBulkPasswords);
        clearHistoryBtn.addEventListener('click', clearPasswordHistory);
    }
    
    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', initializePasswordGenerator);
    
    // Expose globally for dynamic loading
    window.initializePasswordGenerator = initializePasswordGenerator;
    
    function updateLengthDisplay() {
        lengthDisplay.textContent = lengthSlider.value;
    }
    
    function getCharacterSet() {
        let charset = '';
        
        if (document.getElementById('include-uppercase').checked) {
            charset += charSets.uppercase;
        }
        if (document.getElementById('include-lowercase').checked) {
            charset += charSets.lowercase;
        }
        if (document.getElementById('include-numbers').checked) {
            charset += charSets.numbers;
        }
        if (document.getElementById('include-symbols').checked) {
            charset += charSets.symbols;
        }
        if (document.getElementById('include-extended').checked) {
            charset += charSets.extended;
        }
        
        // Apply filters
        if (document.getElementById('exclude-ambiguous').checked) {
            charset = charset.split('').filter(char => !ambiguousChars.includes(char)).join('');
        }
        if (document.getElementById('exclude-similar').checked) {
            charset = charset.split('').filter(char => !similarChars.includes(char)).join('');
        }
        
        return charset;
    }
    
    function generatePassword(length, charset) {
        if (!charset) {
            throw new Error('No character types selected');
        }
        
        let password = '';
        const requireEach = document.getElementById('require-each-type').checked;
        const noRepeating = document.getElementById('no-repeating').checked;
        
        if (requireEach) {
            // Add at least one character from each selected type
            const types = [];
            if (document.getElementById('include-uppercase').checked) types.push(charSets.uppercase);
            if (document.getElementById('include-lowercase').checked) types.push(charSets.lowercase);
            if (document.getElementById('include-numbers').checked) types.push(charSets.numbers);
            if (document.getElementById('include-symbols').checked) types.push(charSets.symbols);
            if (document.getElementById('include-extended').checked) types.push(charSets.extended);
            
            for (const type of types) {
                let char;
                do {
                    char = type[Math.floor(Math.random() * type.length)];
                } while (noRepeating && password.includes(char));
                
                if (charset.includes(char)) {
                    password += char;
                }
            }
        }
        
        // Fill remaining length
        const usedChars = noRepeating ? new Set(password) : new Set();
        while (password.length < length) {
            const char = charset[Math.floor(Math.random() * charset.length)];
            if (!noRepeating || !usedChars.has(char)) {
                password += char;
                if (noRepeating) usedChars.add(char);
            }
            
            // Prevent infinite loop if not enough unique characters
            if (noRepeating && usedChars.size >= charset.length && password.length < length) {
                break;
            }
        }
        
        // Shuffle the password
        return password.split('').sort(() => Math.random() - 0.5).join('');
    }
    
    function calculatePasswordStrength(password) {
        let score = 0;
        let feedback = [];
        
        // Length scoring
        if (password.length >= 12) score += 25;
        else if (password.length >= 8) score += 15;
        else if (password.length >= 6) score += 10;
        else score += 5;
        
        // Character variety
        if (/[a-z]/.test(password)) score += 15;
        if (/[A-Z]/.test(password)) score += 15;
        if (/[0-9]/.test(password)) score += 15;
        if (/[^a-zA-Z0-9]/.test(password)) score += 20;
        
        // Additional complexity
        if (password.length >= 16) score += 10;
        if (/[!@#$%^&*()_+\-=\[\]{}|;':\",./<>?]/.test(password)) score += 10;
        
        // Determine strength level
        let level, color, text;
        if (score >= 80) {
            level = 'Very Strong';
            color = '#228B22';
            text = 'Excellent password strength';
        } else if (score >= 60) {
            level = 'Strong';
            color = '#32CD32';
            text = 'Good password strength';
        } else if (score >= 40) {
            level = 'Medium';
            color = '#FFA500';
            text = 'Moderate password strength';
        } else if (score >= 20) {
            level = 'Weak';
            color = '#FF6347';
            text = 'Weak password - consider making it longer';
        } else {
            level = 'Very Weak';
            color = '#DC143C';
            text = 'Very weak password - use more characters';
        }
        
        return { score: Math.min(score, 100), level, color, text };
    }
    
    function displayPasswordStrength(password) {
        const strength = calculatePasswordStrength(password);
        
        strengthFill.style.width = strength.score + '%';
        strengthFill.style.backgroundColor = strength.color;
        strengthText.textContent = `${strength.level} (${strength.score}/100) - ${strength.text}`;
        strengthText.style.color = strength.color;
    }
    
    function generateSinglePassword() {
        try {
            const length = parseInt(lengthSlider.value);
            const charset = getCharacterSet();
            const password = generatePassword(length, charset);
            
            passwordDisplay.textContent = password;
            passwordResult.classList.remove('hidden');
            displayPasswordStrength(password);
            
            // Scroll to result
            passwordResult.scrollIntoView({ behavior: 'smooth' });
        } catch (error) {
            alert(error.message);
        }
    }
    
    function generateMultiplePasswords() {
        try {
            const length = parseInt(lengthSlider.value);
            const charset = getCharacterSet();
            const passwords = [];
            
            for (let i = 0; i < 5; i++) {
                passwords.push(generatePassword(length, charset));
            }
            
            const passwordsText = passwords.join('\n');
            bulkPasswords.textContent = passwordsText;
            bulkPasswords.classList.remove('hidden');
            bulkCopyBtn.classList.remove('hidden');
            bulkDownloadBtn.classList.remove('hidden');
            
            // Scroll to result
            bulkPasswords.scrollIntoView({ behavior: 'smooth' });
        } catch (error) {
            alert(error.message);
        }
    }
    
    function generateBulkPasswords() {
        try {
            const count = parseInt(document.getElementById('bulk-count').value);
            const length = parseInt(lengthSlider.value);
            const charset = getCharacterSet();
            
            if (count < 1 || count > 100) {
                alert('Please enter a number between 1 and 100');
                return;
            }
            
            const passwords = [];
            for (let i = 0; i < count; i++) {
                passwords.push(generatePassword(length, charset));
            }
            
            const passwordsText = passwords.join('\n');
            bulkPasswords.textContent = passwordsText;
            bulkPasswords.classList.remove('hidden');
            bulkCopyBtn.classList.remove('hidden');
            bulkDownloadBtn.classList.remove('hidden');
            
            // Scroll to result
            bulkPasswords.scrollIntoView({ behavior: 'smooth' });
        } catch (error) {
            alert(error.message);
        }
    }
    
    function copyPassword() {
        navigator.clipboard.writeText(passwordDisplay.textContent).then(() => {
            const originalText = copyBtn.textContent;
            copyBtn.textContent = 'Copied!';
            copyBtn.style.background = '#228B22';
            setTimeout(() => {
                copyBtn.textContent = originalText;
                copyBtn.style.background = '#4682B4';
            }, 2000);
        }).catch(() => {
            alert('Failed to copy password');
        });
    }
    
    function copyBulkPasswords() {
        navigator.clipboard.writeText(bulkPasswords.textContent).then(() => {
            const originalText = bulkCopyBtn.textContent;
            bulkCopyBtn.textContent = 'Copied!';
            bulkCopyBtn.style.background = '#228B22';
            setTimeout(() => {
                bulkCopyBtn.textContent = originalText;
                bulkCopyBtn.style.background = '#4682B4';
            }, 2000);
        }).catch(() => {
            alert('Failed to copy passwords');
        });
    }
    
    function downloadBulkPasswords() {
        const passwords = bulkPasswords.textContent;
        const blob = new Blob([passwords], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'passwords.txt';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }
    
    function savePasswordToHistory() {
        const password = passwordDisplay.textContent;
        if (password) {
            const timestamp = new Date().toLocaleString();
            passwordHistory.unshift({ password, timestamp });
            passwordHistory = passwordHistory.slice(0, 20); // Keep only last 20
            localStorage.setItem('passwordHistory', JSON.stringify(passwordHistory));
            updateHistoryDisplay();
            
            const originalText = saveBtn.textContent;
            saveBtn.textContent = 'Saved!';
            saveBtn.style.background = '#228B22';
            setTimeout(() => {
                saveBtn.textContent = originalText;
                saveBtn.style.background = '#4682B4';
            }, 2000);
        }
    }
    
    function updateHistoryDisplay() {
        if (passwordHistory.length === 0) {
            passwordHistoryDiv.classList.add('hidden');
            return;
        }
        
        passwordHistoryDiv.classList.remove('hidden');
        historyList.innerHTML = '';
        
        passwordHistory.forEach((item, index) => {
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            
            const passwordDiv = document.createElement('div');
            passwordDiv.className = 'history-password';
            passwordDiv.textContent = item.password;
            
            const timestampDiv = document.createElement('div');
            timestampDiv.style.fontSize = '0.8em';
            timestampDiv.style.color = '#666';
            timestampDiv.style.marginRight = '1em';
            timestampDiv.textContent = item.timestamp;
            
            const copyButton = document.createElement('button');
            copyButton.className = 'gen-btn secondary';
            copyButton.style.padding = '0.5em 1em';
            copyButton.style.fontSize = '0.9em';
            copyButton.textContent = 'Copy';
            copyButton.onclick = () => copyHistoryPassword(item.password);
            
            historyItem.appendChild(passwordDiv);
            historyItem.appendChild(timestampDiv);
            historyItem.appendChild(copyButton);
            
            historyList.appendChild(historyItem);
        });
    }
    
    function clearPasswordHistory() {
        if (confirm('Are you sure you want to clear the password history?')) {
            passwordHistory = [];
            localStorage.removeItem('passwordHistory');
            updateHistoryDisplay();
        }
    }
    
    // Global function for history copy
    window.copyHistoryPassword = function(password) {
        navigator.clipboard.writeText(password).then(() => {
            // Visual feedback would go here
        }).catch(() => {
            alert('Failed to copy password');
        });
    };
})();
</script>
</body>
</html>
