<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>India Precious Metals Price Tracker - City Wise Rates</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #0f3460;
            --gold: #ffd700;
            --silver: #c0c0c0;
            --platinum: #e5e4e2;
            --diamond: #b9f2ff;
            --success: #4caf50;
            --danger: #f44336;
            --warning: #ff9800;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --card-bg: rgba(255, 255, 255, 0.05);
            --border-color: rgba(255, 255, 255, 0.1);
            --saffron: #ff9933;
            --green: #138808;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            position: relative;
        }

        .india-flag {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }

        .flag-strip {
            height: 4px;
            width: 100px;
        }

        .flag-saffron { background: var(--saffron); }
        .flag-white { background: white; }
        .flag-green { background: var(--green); }

        .ashoka-chakra {
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid var(--saffron);
            border-radius: 50%;
            left: 50%;
            transform: translateX(-50%);
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--saffron), var(--gold), var(--green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.5)); }
            to { filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8)); }
        }

        .city-selector {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .city-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .city-tab {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-color);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .city-tab:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .city-tab.active {
            background: linear-gradient(135deg, var(--saffron), var(--gold));
            color: var(--primary);
            font-weight: bold;
        }

        .last-update {
            color: var(--text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            margin-top: 10px;
        }

        .pulse {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
        }

        .price-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .price-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .price-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--saffron), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .price-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .metal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .metal-name {
            font-size: 1.3rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .metal-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .gold-icon { background: linear-gradient(135deg, #ffd700, #ffed4e); }
        .silver-icon { background: linear-gradient(135deg, #c0c0c0, #e8e8e8); }
        .platinum-icon { background: linear-gradient(135deg, #e5e4e2, #ffffff); }
        .diamond-icon { background: linear-gradient(135deg, #b9f2ff, #ffffff); }

        .current-price {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .price-change {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .change-positive {
            color: var(--success);
        }

        .change-negative {
            color: var(--danger);
        }

        .price-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }

        .detail-item {
            font-size: 0.85rem;
        }

        .detail-label {
            color: var(--text-secondary);
        }

        .detail-value {
            font-weight: bold;
            color: var(--text-primary);
        }

        .regional-comparison {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .city-price-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .city-price-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: scale(1.05);
        }

        .city-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--saffron);
        }

        .city-price {
            font-size: 1.2rem;
            color: var(--gold);
        }

        .tax-info {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .tax-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .tax-item {
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            border-left: 3px solid var(--saffron);
        }

        .tax-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .tax-value {
            font-size: 1.1rem;
            font-weight: bold;
        }

        .chart-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .chart-canvas {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        canvas {
            width: 100% !important;
            height: 100% !important;
        }

        .alert-banner {
            background: linear-gradient(135deg, var(--saffron), var(--warning));
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .alert-banner.show {
            display: block;
        }

        .market-insights {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .insight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .insight-card {
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .insight-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .insight-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--gold);
        }

        .insight-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8rem; }
            .city-tabs { justify-content: center; }
            .price-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="india-flag">
                <div class="flag-strip flag-saffron"></div>
                <div class="flag-strip flag-white"></div>
                <div class="flag-strip flag-green"></div>
                <div class="ashoka-chakra"></div>
            </div>
            <h1>üáÆüá≥ India Precious Metals Tracker</h1>
            <div class="last-update">
                <span class="pulse"></span>
                <span id="updateTime">Last updated: Loading...</span>
            </div>
        </header>

        <div class="alert-banner" id="alertBanner">
            <strong>üîî Market Alert:</strong> <span id="alertMessage"></span>
        </div>

        <div class="city-selector">
            <h2 style="margin-bottom: 10px;">üìç Select City</h2>
            <div class="city-tabs" id="cityTabs">
                <!-- City tabs will be dynamically generated -->
            </div>
        </div>

        <div class="price-cards" id="priceCards">
            <!-- Price cards will be dynamically generated -->
        </div>

        <div class="regional-comparison">
            <h2>üèôÔ∏è Gold Price Comparison Across Cities (per 10g)</h2>
            <div class="comparison-grid" id="cityComparison">
                <!-- City comparison will be dynamically generated -->
            </div>
        </div>

        <div class="tax-info">
            <h2>üí∞ Tax & Charges Breakdown</h2>
            <div class="tax-breakdown" id="taxBreakdown">
                <!-- Tax breakdown will be dynamically generated -->
            </div>
        </div>

        <div class="market-insights">
            <h2>üìä Market Insights</h2>
            <div class="insight-grid" id="insightGrid">
                <!-- Insights will be dynamically generated -->
            </div>
        </div>

        <div class="chart-container">
            <h2>üìà Price Trends (7 Days)</h2>
            <div class="chart-canvas">
                <canvas id="priceChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Indian cities with their specific characteristics
        const indianCities = {
            mumbai: {
                name: 'Mumbai',
                state: 'Maharashtra',
                taxMultiplier: 1.03,
                demand: 'high',
                makingCharge: { gold: 8, silver: 5, platinum: 10, diamond: 15 }
            },
            delhi: {
                name: 'Delhi',
                state: 'Delhi',
                taxMultiplier: 1.025,
                demand: 'high',
                makingCharge: { gold: 7, silver: 4, platinum: 9, diamond: 12 }
            },
            bangalore: {
                name: 'Bangalore',
                state: 'Karnataka',
                taxMultiplier: 1.02,
                demand: 'medium',
                makingCharge: { gold: 6, silver: 3, platinum: 8, diamond: 10 }
            },
            chennai: {
                name: 'Chennai',
                state: 'Tamil Nadu',
                taxMultiplier: 1.015,
                demand: 'medium',
                makingCharge: { gold: 5, silver: 3, platinum: 7, diamond: 10 }
            },
            kolkata: {
                name: 'Kolkata',
                state: 'West Bengal',
                taxMultiplier: 1.01,
                demand: 'low',
                makingCharge: { gold: 4, silver: 2, platinum: 6, diamond: 8 }
            },
            hyderabad: {
                name: 'Hyderabad',
                state: 'Telangana',
                taxMultiplier: 1.018,
                demand: 'medium',
                makingCharge: { gold: 6, silver: 3, platinum: 8, diamond: 11 }
            },
            pune: {
                name: 'Pune',
                state: 'Maharashtra',
                taxMultiplier: 1.022,
                demand: 'medium',
                makingCharge: { gold: 6, silver: 4, platinum: 8, diamond: 11 }
            },
            jaipur: {
                name: 'Jaipur',
                state: 'Rajasthan',
                taxMultiplier: 1.012,
                demand: 'low',
                makingCharge: { gold: 5, silver: 2, platinum: 7, diamond: 9 }
            }
        };

        // Precious metals data
        const metals = {
            gold: {
                name: 'Gold',
                purity: '24K',
                unit: '10 grams',
                basePrice: 62000,
                volatility: 0.015,
                color: '#ffd700',
                icon: 'üèÜ',
                gst: 3
            },
            silver: {
                name: 'Silver',
                purity: '999',
                unit: '1 kg',
                basePrice: 75000,
                volatility: 0.02,
                color: '#c0c0c0',
                icon: 'ü•à',
                gst: 3
            },
            platinum: {
                name: 'Platinum',
                purity: '999',
                unit: '10 grams',
                basePrice: 32000,
                volatility: 0.018,
                color: '#e5e4e2',
                icon: '‚ö™',
                gst: 3
            },
            diamond: {
                name: 'Diamond',
                purity: 'VVS',
                unit: '1 carat',
                basePrice: 250000,
                volatility: 0.012,
                color: '#b9f2ff',
                icon: 'üíé',
                gst: 3
            }
        };

        // Global variables
        let selectedCity = 'mumbai';
        let priceHistory = {};
        let currentPrices = {};

        // Initialize price history for all cities
        function initializePriceHistory() {
            Object.keys(indianCities).forEach(city => {
                priceHistory[city] = {};
                Object.keys(metals).forEach(metal => {
                    priceHistory[city][metal] = [];
                    const days = 7;
                    let price = metals[metal].basePrice;
                    
                    for (let i = days; i >= 0; i--) {
                        const cityMultiplier = indianCities[city].taxMultiplier;
                        const change = (Math.random() - 0.5) * metals[metal].volatility * price;
                        price += change;
                        priceHistory[city][metal].push({
                            date: new Date(Date.now() - i * 24 * 60 * 60 * 1000),
                            price: price * cityMultiplier
                        });
                    }
                });
            });
        }

        // Update prices
        function updatePrices() {
            Object.keys(indianCities).forEach(city => {
                Object.keys(metals).forEach(metal => {
                    const history = priceHistory[city][metal];
                    const lastPrice = history[history.length - 1].price;
                    const volatility = metals[metal].volatility;
                    const trend = Math.sin(Date.now() / 100000) * 0.5;
                    const randomChange = (Math.random() - 0.5 + trend * 0.1) * volatility * lastPrice;
                    const newPrice = Math.max(0, lastPrice + randomChange);
                    
                    history.push({
                        date: new Date(),
                        price: newPrice
                    });
                    
                    if (history.length > 168) {
                        history.shift();
                    }
                });
            });
            
            updateDisplay();
            checkForAlerts();
        }

        // Calculate price with taxes and making charges
        function calculateFinalPrice(city, metal) {
            const basePrice = priceHistory[city][metal][priceHistory[city][metal].length - 1].price;
            const cityData = indianCities[city];
            const metalData = metals[metal];
            
            // Add GST
            const withGST = basePrice * (1 + metalData.gst / 100);
            
            // Add making charges
            const makingChargePercent = cityData.makingCharge[metal];
            const finalPrice = withGST * (1 + makingChargePercent / 100);
            
            return finalPrice;
        }

        // Calculate price change
        function calculatePriceChange(city, metal) {
            const history = priceHistory[city][metal];
            if (history.length < 2) return { change: 0, percent: 0 };
            
            const current = calculateFinalPrice(city, metal);
            const previous = history[history.length - 2].price * (1 + metals[metal].gst / 100) * 
                           (1 + indianCities[city].makingCharge[metal] / 100);
            const change = current - previous;
            const percent = (change / previous) * 100;
            
            return { change, percent };
        }

        // Update display
        function updateDisplay() {
            updateCityTabs();
            updatePriceCards();
            updateCityComparison();
            updateTaxBreakdown();
            updateInsights();
            updateChart();
            updateTime();
        }

        // Update city tabs
        function updateCityTabs() {
            const container = document.getElementById('cityTabs');
            container.innerHTML = '';
            
            Object.keys(indianCities).forEach(cityKey => {
                const city = indianCities[cityKey];
                const tab = document.createElement('div');
                tab.className = `city-tab ${cityKey === selectedCity ? 'active' : ''}`;
                tab.textContent = `${city.name}, ${city.state}`;
                tab.onclick = () => {
                    selectedCity = cityKey;
                    updateDisplay();
                };
                container.appendChild(tab);
            });
        }

        // Update price cards
        function updatePriceCards() {
            const container = document.getElementById('priceCards');
            container.innerHTML = '';
            
            Object.keys(metals).forEach(metal => {
                const metalData = metals[metal];
                const finalPrice = calculateFinalPrice(selectedCity, metal);
                const change = calculatePriceChange(selectedCity, metal);
                const cityData = indianCities[selectedCity];
                
                const card = document.createElement('div');
                card.className = 'price-card';
                card.innerHTML = `
                    <div class="metal-header">
                        <div class="metal-name">
                            <div class="metal-icon ${metal}-icon">${metalData.icon}</div>
                            ${metalData.name} ${metalData.purity}
                        </div>
                        <span style="color: var(--text-secondary); font-size: 0.9rem;">${metalData.unit}</span>
                    </div>
                    <div class="current-price">‚Çπ${finalPrice.toLocaleString('en-IN')}</div>
                    <div class="price-change ${change.percent >= 0 ? 'change-positive' : 'change-negative'}">
                        <span>${change.percent >= 0 ? '‚ñ≤' : '‚ñº'}</span>
                        <span>${Math.abs(change.percent).toFixed(2)}%</span>
                        <span>(‚Çπ${Math.abs(change.change).toLocaleString('en-IN', {maximumFractionDigits: 0})})</span>
                    </div>
                    <div class="price-details">
                        <div class="detail-item">
                            <div class="detail-label">Base Price</div>
                            <div class="detail-value">‚Çπ${priceHistory[selectedCity][metal][priceHistory[selectedCity][metal].length - 1].price.toLocaleString('en-IN')}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">GST (3%)</div>
                            <div class="detail-value">‚Çπ${(priceHistory[selectedCity][metal][priceHistory[selectedCity][metal].length - 1].price * 0.03).toLocaleString('en-IN')}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Making Charge</div>
                            <div class="detail-value">${cityData.makingCharge[metal]}%</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Demand Level</div>
                            <div class="detail-value" style="color: ${cityData.demand === 'high' ? 'var(--success)' : cityData.demand === 'medium' ? 'var(--warning)' : 'var(--danger)'}">
                                ${cityData.demand.toUpperCase()}
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        // Update city comparison
        function updateCityComparison() {
            const container = document.getElementById('cityComparison');
            container.innerHTML = '';
            
            Object.keys(indianCities).forEach(cityKey => {
                const city = indianCities[cityKey];
                const goldPrice = calculateFinalPrice(cityKey, 'gold');
                
                const item = document.createElement('div');
                item.className = 'city-price-item';
                item.innerHTML = `
                    <div class="city-name">${city.name}</div>
                    <div class="city-price">‚Çπ${goldPrice.toLocaleString('en-IN')}</div>
                `;
                
                container.appendChild(item);
            });
        }

        // Update tax breakdown
        function updateTaxBreakdown() {
            const container = document.getElementById('taxBreakdown');
            const cityData = indianCities[selectedCity];
            const goldPrice = priceHistory[selectedCity].gold[priceHistory[selectedCity].gold.length - 1].price;
            
            container.innerHTML = `
                <div class="tax-item">
                    <div class="tax-label">GST on Gold</div>
                    <div class="tax-value">3% (‚Çπ${(goldPrice * 0.03).toLocaleString('en-IN')})</div>
                </div>
                <div class="tax-item">
                    <div class="tax-label">Making Charges (Gold)</div>
                    <div class="tax-value">${cityData.makingCharge.gold}%</div>
                </div>
                <div class="tax-item">
                    <div class="tax-label">State Tax</div>
                    <div class="tax-value">${((cityData.taxMultiplier - 1) * 100).toFixed(1)}%</div>
                </div>
                <div class="tax-item">
                    <div class="tax-label">Total Tax Component</div>
                    <div class="tax-value">${(3 + cityData.makingCharge.gold + ((cityData.taxMultiplier - 1) * 100)).toFixed(1)}%</div>
                </div>
            `;
        }

        // Update insights
        function updateInsights() {
            const container = document.getElementById('insightGrid');
            
            // Calculate insights
            let highestPrice = 0;
            let lowestPrice = Infinity;
            let highestCity = '';
            let lowestCity = '';
            
            Object.keys(indianCities).forEach(cityKey => {
                const goldPrice = calculateFinalPrice(cityKey, 'gold');
                if (goldPrice > highestPrice) {
                    highestPrice = goldPrice;
                    highestCity = indianCities[cityKey].name;
                }
                if (goldPrice < lowestPrice) {
                    lowestPrice = goldPrice;
                    lowestCity = indianCities[cityKey].name;
                }
            });
            
            const avgPrice = Object.keys(indianCities).reduce((sum, city) => 
                sum + calculateFinalPrice(city, 'gold'), 0) / Object.keys(indianCities).length;
            
            const priceDiff = highestPrice - lowestPrice;
            
            container.innerHTML = `
                <div class="insight-card">
                    <div class="insight-icon">üèÜ</div>
                    <div class="insight-value">${highestCity}</div>
                    <div class="insight-label">Highest Price</div>
                </div>
                <div class="insight-card">
                    <div class="insight-icon">üìâ</div>
                    <div class="insight-value">${lowestCity}</div>
                    <div class="insight-label">Lowest Price</div>
                </div>
                <div class="insight-card">
                    <div class="insight-icon">üí∞</div>
                    <div class="insight-value">‚Çπ${avgPrice.toLocaleString('en-IN', {maximumFractionDigits: 0})}</div>
                    <div class="insight-label">National Average</div>
                </div>
                <div class="insight-card">
                    <div class="insight-icon">üìä</div>
                    <div class="insight-value">‚Çπ${priceDiff.toLocaleString('en-IN', {maximumFractionDigits: 0})}</div>
                    <div class="insight-label">Price Difference</div>
                </div>
            `;
        }

        // Draw chart
        function drawChart() {
            const canvas = document.getElementById('priceChart');
            const ctx = canvas.getContext('2d');
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = rect.height;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const padding = 40;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 2;
            
            // Get gold prices for selected city
            const history = priceHistory[selectedCity].gold.slice(-7);
            const prices = history.map(h => h.price);
            const labels = history.map(h => h.date.toLocaleDateString('en-IN', { weekday: 'short' }));
            
            const minValue = Math.min(...prices);
            const maxValue = Math.max(...prices);
            const valueRange = maxValue - minValue;
            
            // Draw grid
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 1;
            
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
                
                // Y-axis labels
                ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                ctx.font = '10px Arial';
                ctx.textAlign = 'right';
                const value = maxValue - (valueRange / 5) * i;
                ctx.fillText('‚Çπ' + Math.round(value).toLocaleString('en-IN'), padding - 5, y + 3);
            }
            
            // Draw line chart
            ctx.strokeStyle = metals.gold.color;
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            prices.forEach((price, index) => {
                const x = padding + (chartWidth / (prices.length - 1)) * index;
                const y = padding + chartHeight - ((price - minValue) / valueRange) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
                
                // Draw points
                ctx.fillStyle = metals.gold.color;
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, Math.PI * 2);
                ctx.fill();
            });
            
            ctx.stroke();
            
            // Draw X-axis labels
            ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
            ctx.font = '10px Arial';
            ctx.textAlign = 'center';
            
            labels.forEach((label, index) => {
                const x = padding + (chartWidth / (labels.length - 1)) * index;
                ctx.fillText(label, x, canvas.height - 10);
            });
        }

        // Update chart
        function updateChart() {
            drawChart();
        }

        // Check for alerts
        function checkForAlerts() {
            const alertBanner = document.getElementById('alertBanner');
            const alertMessage = document.getElementById('alertMessage');
            
            Object.keys(metals).forEach(metal => {
                const change = calculatePriceChange(selectedCity, metal);
                if (Math.abs(change.percent) > 2) {
                    alertMessage.textContent = `${metals[metal].name} price in ${indianCities[selectedCity].name} has ${change.percent >= 0 ? 'increased' : 'decreased'} by ${Math.abs(change.percent).toFixed(2)}%!`;
                    alertBanner.classList.add('show');
                    setTimeout(() => {
                        alertBanner.classList.remove('show');
                    }, 5000);
                }
            });
        }

        // Update time
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-IN', { 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit' 
            });
            document.getElementById('updateTime').textContent = `Last updated: ${timeString} IST`;
        }

        // Initialize and start updates
        function init() {
            initializePriceHistory();
            updateDisplay();
            
            // Update every 5 seconds
            setInterval(updatePrices, 5000);
            
            // Update time every second
            setInterval(updateTime, 1000);
            
            // Redraw chart on window resize
            window.addEventListener('resize', drawChart);
        }

        // Start the application
        init();
    </script>
</body>
</html>